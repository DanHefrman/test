<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>12-elm-getting-started-and-bundling-with-webpack</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<p><a href="http://elm-lang.org">ELM lang</a> is a new language to write reliable web apps which will generate javascript with performance in focus and no runtime exceptions. To get started we need to go through the <a href="https://guide.elm-lang.org/architecture/">The Elm Architecture</a> and understand the basic pattern of <code>Model</code>, <code>Update</code> and <code>View</code>.</p>
<p>Once we were done we can start with playing with some snippets. In this post, we will cover * How to setup ELM * How to start playing with a <strong>Hello world</strong> example. * How to bundle your app with webpack.</p>
<h2 id="installing-elm">Installing ELM</h2>
<p>If ELM is not installed in your system, the easiest way to install ELM is installing it from <code>npm</code>.</p>
<pre><code>npm install -g elm elm-live</code></pre>
<p><a href="http://npm.im/elm">elm</a> will install <code>elm-package</code>, <code>elm-reactor</code>, <code>elm-make</code> &amp; <code>elm-repl</code> and <a href="https://github.com/tomekwi/elm-live">elm-live</a> is a flexible dev server with live reloading.</p>
<p>elm install</p>
<h2 id="setup-elm-project">Setup ELM project</h2>
<p>Since we have ELM installed in the system now, we can get started with installing the elm dependencies using <code>elm package</code> in an empty directory.</p>
<pre><code>elm package install</code></pre>
<p>This will install <code>elm-lang/core</code>, <code>elm-lang/virtual-dom</code> &amp; <code>elm-lang/html</code>. Also this command will generate a <code>elm-package.json</code> file.</p>
<figure>
<img src="https://s3.ap-south-1.amazonaws.com/revathskumar-blog-images/2017/elm-webpack/elm-packge-install.png" alt="elm package install" /><figcaption>elm package install</figcaption>
</figure>
<p>A sample <code>elm-package.json</code> will look like the one below.</p>
<pre><code>// elm-package.json
{
    &quot;version&quot;: &quot;1.0.0&quot;,
    &quot;summary&quot;: &quot;helpful summary of your project, less than 80 characters&quot;,
    &quot;repository&quot;: &quot;https://github.com/user/project.git&quot;,
    &quot;license&quot;: &quot;BSD3&quot;,
    &quot;source-directories&quot;: [
        &quot;.&quot;
    ],
    &quot;exposed-modules&quot;: [],
    &quot;dependencies&quot;: {
        &quot;elm-lang/core&quot;: &quot;5.1.1 &lt;= v &lt; 6.0.0&quot;,
        &quot;elm-lang/html&quot;: &quot;2.0.0 &lt;= v &lt; 3.0.0&quot;
    },
    &quot;elm-version&quot;: &quot;0.18.0 &lt;= v &lt; 0.19.0&quot;
}</code></pre>
<p>Now, let’s write a ELM program to show <strong>Hello World</strong>.</p>
<pre><code>-- index.elm
import Html exposing (..)
import Html.Attributes exposing (..)

main = span [class &quot;welcome&quot;] [text &quot;Hello World&quot;]</code></pre>
<p>Now, let’s run <code>elm reactor</code> and open <code>http://localhost:8000/</code> see its running in the browser.</p>
<figure>
<img src="https://s3.ap-south-1.amazonaws.com/revathskumar-blog-images/2017/elm-webpack/elm-hello-world.png" alt="elm in browser" /><figcaption>elm in browser</figcaption>
</figure>
<p>We can run <code>elm live</code> if we need the live reload for our development.</p>
<p>The hello world example have on <code>View</code> part in the basic ELM pattern. Let’s look into another example which has a <code>Model</code> &amp; <code>Update</code>.</p>
<pre><code>-- counter.elm
import Html exposing (..)
import Html.Events exposing (onClick)

type alias Model = Int
type Action = NoOp | Inc | Dec

update : Action -&gt; Model -&gt; ( Model, Cmd Action)
update action model =
  case action of
    NoOp -&gt; (model, Cmd.none)
    Inc -&gt; (model + 1, Cmd.none)
    Dec -&gt; (model - 1, Cmd.none)

view : Model -&gt; Html Action
view model =
  div [] [
    div [] [text &quot;Counter&quot;],
    div [] [text (&quot;From model :: &quot; ++ (toString model))],
    div [] [
      button [onClick Dec] [text &quot;-&quot;],
      span [] [text (toString model)],
      button [onClick Inc] [text &quot;+&quot;]
    ]
  ]

init : ( Model, Cmd Action )
init =
  (0, Cmd.none)

subscriptions : Model -&gt; Sub Action
subscriptions model =
  Sub.none

main =
  Html.program {init = init, update = update, view = view, subscriptions = subscriptions}</code></pre>
<p>Now we know how to run small ELM program, but when it comes to a real project we will be using bundling tools like <code>webpack</code>. Next, we will look into how we can bundle a ELM program with <strong>webpack</strong>. We will use the same counter program to bundle and run with webpack.</p>
<h2 id="bundling-with-webpack">Bundling with Webpack</h2>
<p>We will start with setting up a <code>index.html</code> &amp; the entry point <code>index.js</code></p>
<pre><code>&lt;!--index.html--&gt;

&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;ELM Counter&lt;/title&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div id=&quot;elm-app&quot;&gt;&lt;/div&gt;
    &lt;script async src=&quot;app.js&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>The above snippet will assume that our webpack config will compile the ELM to <code>app.js</code>.</p>
<p>Now the entry point <code>index.js</code> need to take care of requiring <code>counter.elm</code> and mounting the ELM app in the <code>div#elm-app</code>.</p>
<pre><code>// index.js
&#39;use strict&#39;;

var Elm = require(&#39;./counter.elm&#39;);
var mountNode = document.getElementById(&#39;elm-app&#39;);

// The third value on embed are the initial values for incomming ports into Elm
var app = Elm.Main.embed(mountNode);</code></pre>
<h3 id="installing-configuring-webpack">Installing &amp; configuring webpack</h3>
<p>Let’s create a <code>package.json</code> using <code>npm init</code> command and then install the webpack and other dependencies.</p>
<pre><code>npm install --save elm-webpack-loader webpack webpack-dev-server</code></pre>
<p>Now let’s configure the webapack with <code>elm-webpack-loader</code>.</p>
<pre><code>// webpack.config.js
module.exports = {
  entry: {
    app: [
      &#39;./index.js&#39;
    ]
  },

  output: {
    filename: &#39;[name].js&#39;,
  },

  module: {
    loaders: [
      {
        test:    /\.elm$/,
        exclude: [/elm-stuff/, /node_modules/],
        loader:  &#39;elm-webpack-loader?verbose=true&amp;warn=true&#39;,
      },
    ],

    noParse: /\.elm$/,
  },

  devServer: {
    inline: true,
    stats: { colors: true },
  }
};</code></pre>
<p>Now we are done with configuring webpack with elm loader, Let’s see this in action by executing the command</p>
<pre><code>./node_modules/.bin/webpack-dev-server</code></pre>
<p>and open the <code>http://localhost:8081/</code> in the browser.</p>
<figure>
<img src="https://s3.ap-south-1.amazonaws.com/revathskumar-blog-images/2017/elm-webpack/elm-counter-webpack.png" alt="elm counter app in browser" /><figcaption>elm counter app in browser</figcaption>
</figure>
</body>
</html>
