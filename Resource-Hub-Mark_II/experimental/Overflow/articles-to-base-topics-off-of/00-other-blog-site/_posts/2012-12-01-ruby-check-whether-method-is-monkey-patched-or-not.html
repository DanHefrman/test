<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>2012-12-01-ruby-check-whether-method-is-monkey-patched-or-not</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<p><a href="http://4.bp.blogspot.com/-WmuA8WUESDw/ULd2dAWD2cI/AAAAAAAAJls/eDxKoBO_tAQ/s1600/ruby-monkey-patch.jpg"><img src="http://4.bp.blogspot.com/-WmuA8WUESDw/ULd2dAWD2cI/AAAAAAAAJls/eDxKoBO_tAQ/s400/ruby-monkey-patch.jpg" width="400" height="300" /></a></p>
<p>Consider a situation that one of the ruby method is acting weird, means not delivering the expected functionality. So you doubt that some of the gem is monkey patched that method. How you are going to find the monkey patch?</p>
<p>Here is the simple solution to make sure that the method is not monkey patched, or get the file and line number where the method is patched.</p>
<p>The trick works with the help of <a href="http://www.ruby-doc.org/core-1.9.3/Method.html#method-i-source_location">source_location</a> method. <strong>This method will return the file path and line number of the method or nil if the method is native</strong>.</p>
<p><a href="http://4.bp.blogspot.com/-SyvwFMQG3FQ/ULe7Fkcpk9I/AAAAAAAAJpM/8zOWwvrm8AY/s1600/ruby-check-monkey-patch.png"><img src="http://4.bp.blogspot.com/-SyvwFMQG3FQ/ULe7Fkcpk9I/AAAAAAAAJpM/8zOWwvrm8AY/s400/ruby-check-monkey-patch.png" width="400" height="328" /></a></p>
<p>In the above sample I tried to monkey patch the <a href="http://www.ruby-doc.org/core-1.9.3/String.html#method-i-split">split</a> method of <a href="http://www.ruby-doc.org/core-1.9.3/String.html">String</a> class. In line number 2 you can see that the <em>source_location</em> method returns <em>“nil”</em> since the method is not patched. But in line number 5 you can see that the <em>source_location</em> method returns an array of two elements, first is the file path, in this case it is pry/irb,  second one is the line number.</p>
<p>Here is the snippet I used in the above example. You can fork and try to execute it.</p>
<pre><code># Before Monkey patch
reply = &quot;Hello world&quot;
p reply.method(:split).source_location

# Monkey patch
class String
  def split
    p &quot;Monkey patch&quot;
  end
end

# After Monkey patch
p reply.method(:split).source_location</code></pre>
<p>Hope this will save your time.<br />
Thank you.</p>
<p>$</p>
</body>
</html>
